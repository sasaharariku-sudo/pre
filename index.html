<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>アイディア置き場</title>
<style>
    body {
        font-family:"Segoe UI",sans-serif;
        background:#121629;
        color:#fff;
        display:flex;
        flex-direction:column;
        justify-content:center;
        align-items:center;
        height:100vh;
        margin:0;
        position: relative;
    }
    h1 { color:#ffd6dd; margin-bottom:40px; text-align:center; }
    .button-container {
        display:flex;
        gap:40px;
        flex-wrap:wrap;
        justify-content:center;
    }
    .game-button {
        padding:20px 40px;
        font-size:1.5em;
        background-color:#eebbc3;
        color:#232946;
        border:none;
        border-radius:12px;
        cursor:pointer;
        transition:0.2s;
    }
    .game-button:hover { background-color:#ffd6dd; }


    /* ✨ここを早打ち版と完全同じデザインに変更 ✨*/
    #pomodoro-timer {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 220px;
        background-color: rgba(20,22,38,0.95);
        color: #fff;
        border: 2px solid #eebbc3;
        border-radius: 14px;
        padding: 12px;
        text-align: center;
        font-family: "Segoe UI", sans-serif;
        z-index: 9999;
        cursor: move;
        box-shadow: 0px 4px 12px rgba(0,0,0,0.45);
    }
    #pomodoro-time {
        font-size: 1.8em;
        font-weight: 600;
        margin-top: 4px;
    }
    #pomodoro-label {
        font-size: 0.9em;
        margin-top: 2px;
        opacity: 0.8;
    }
    #pomodoro-timer button {
        font-size: 0.95em;
        margin: 3px;
        padding: 6px 10px;
        border-radius: 8px;
        border: none;
        background: #eebbc3;
        color: #232946;
        cursor: pointer;
        transition: 0.15s;
    }
    #pomodoro-timer button:hover {
        background: #ffd6dd;
    }
</style>
</head>
<body>

<h1>アイディア置き場</h1>

<div class="button-container">
    <button class="game-button" onclick="location.href='hayauchi.html'">早打ち単語ゲーム</button>
    <button class="game-button" onclick="location.href='test.html'">英単語テスト</button>
</div>

<!-- ポモドーロタイマーウィンドウ -->
<div id="pomodoro-timer">
  <div style="font-size:1em; margin-bottom:5px;">ポモドーロタイマー</div>
  <div id="pomodoro-time" style="font-size:1.8em;">25:00</div>
  <div id="pomodoro-label" style="font-size:0.9em; margin-top:3px;">作業</div>
  <button id="pomodoro-start">開始</button>
  <button id="pomodoro-stop">停止</button>
  <button id="pomodoro-reset">リセット</button>
</div>

<script>
const timerEl = document.getElementById('pomodoro-timer');
const timeEl = document.getElementById('pomodoro-time');
const labelEl = document.getElementById('pomodoro-label');
const startBtn = document.getElementById('pomodoro-start');
const stopBtn = document.getElementById('pomodoro-stop');
const resetBtn = document.getElementById('pomodoro-reset');

const times = [25,5,25,5];
const labels = ["作業","休憩","作業","休憩"];
let index = parseInt(localStorage.getItem('pomodoroIndex')) || 0;
let seconds = parseInt(localStorage.getItem('pomodoroSeconds')) || times[index]*60;
let interval = null;

// --- タイマー表示更新 ---
function updateDisplay(){
    let min = Math.floor(seconds/60);
    let sec = seconds%60;
    if(sec<10) sec = '0'+sec;
    timeEl.textContent = `${min}:${sec}`;
    labelEl.textContent = labels[index];
}

// --- カウント処理 ---
function countdown(){
    if(seconds <= 0){
        index = (index + 1) % times.length;
        seconds = times[index]*60;
        localStorage.setItem('pomodoroIndex', index);
    } else {
        seconds--;
    }
    localStorage.setItem('pomodoroSeconds', seconds);
    updateDisplay();
}

// --- ボタン操作 ---
startBtn.onclick = () => {
    if(!interval){
        interval = setInterval(countdown, 1000);
        localStorage.setItem('pomodoroRunning', 'true');
    }
};
stopBtn.onclick = () => {
    if(interval){
        clearInterval(interval);
        interval = null;
        localStorage.setItem('pomodoroRunning', 'false');
    }
};
resetBtn.onclick = () => {
    clearInterval(interval);
    interval = null;
    index = 0;
    seconds = times[index]*60;
    localStorage.setItem('pomodoroSeconds', seconds);
    localStorage.setItem('pomodoroIndex', index);
    localStorage.setItem('pomodoroRunning', 'false');
    updateDisplay();
};

// --- localStorageから状態読み込み ---
function loadPomodoroState(){
    index = parseInt(localStorage.getItem('pomodoroIndex')) || 0;
    seconds = parseInt(localStorage.getItem('pomodoroSeconds')) || times[index]*60;
    updateDisplay();
}

// --- storageイベントで他タブ同期 ---
window.addEventListener('storage', (e)=>{
    if(e.key==='pomodoroSeconds' || e.key==='pomodoroIndex' || e.key==='pomodoroRunning'){
        loadPomodoroState();
        if(localStorage.getItem('pomodoroRunning')==='true' && !interval){
            interval = setInterval(countdown,1000);
        } else if(localStorage.getItem('pomodoroRunning')==='false' && interval){
            clearInterval(interval);
            interval=null;
        }
    }
});

// --- ページ読み込み時に表示と状態を更新 ---
loadPomodoroState();
if(localStorage.getItem('pomodoroRunning')==='true' && !interval){
    interval = setInterval(countdown,1000);
}

// --- タイマーのドラッグ ---
let isDragging=false, offsetX=0, offsetY=0;
timerEl.addEventListener('mousedown', e=>{
    isDragging=true;
    offsetX = e.clientX - timerEl.offsetLeft;
    offsetY = e.clientY - timerEl.offsetTop;
});
document.addEventListener('mousemove', e=>{
    if(isDragging){
      timerEl.style.left = (e.clientX - offsetX) + 'px';
      timerEl.style.top = (e.clientY - offsetY) + 'px';
    }
});
document.addEventListener('mouseup', ()=>{
    if(isDragging){
      isDragging=false;
      localStorage.setItem('pomodoroLeft', timerEl.style.left);
      localStorage.setItem('pomodoroTop', timerEl.style.top);
    }
});

// --- 保存された位置を読み込み ---
const savedLeft = localStorage.getItem('pomodoroLeft');
const savedTop = localStorage.getItem('pomodoroTop');
if(savedLeft) timerEl.style.left = savedLeft;
if(savedTop) timerEl.style.top = savedTop;
</script>

</body>
</html>

